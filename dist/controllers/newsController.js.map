{"version":3,"sources":["../../server/controllers/newsController.js"],"names":["require","config","path","newsapi","process","env","API_KEY","exports","getNews","req","res","next","session","news","console","debug","headline","v2","topHeadlines","category","language","country","homePage","bookmarks","render","pageTitle","articles","introPage","introPage2","introPage3"],"mappings":";;AAEA;;;;;;AAFAA,QAAQ,QAAR,EAAkBC,MAAlB,CAAyB,EAAEC,MAAM,YAAR,EAAzB;;AAGA,MAAMC,UAAU,sBAAYC,QAAQC,GAAR,CAAYC,OAAxB,CAAhB;;AAEAC,QAAQC,OAAR,GAAkB,OAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB,KAA0B;AAC3C;AACA;;AAEA,KAAI,CAACF,IAAIG,OAAJ,CAAYC,IAAjB,EAAuB;AACtBC,UAAQC,KAAR,CAAc,mBAAd;;AAEAN,MAAIO,QAAJ,GAAe,MAAMb,QAAQc,EAAR,CAAWC,YAAX,CAAwB;AAC5C;AACA;AACAC,aAAU,YAHkC;AAI5CC,aAAU,IAJkC;AAK5CC,YAAS;AALmC,GAAxB,CAArB;;AAQAZ,MAAIG,OAAJ,CAAYC,IAAZ,GAAmBJ,IAAIO,QAAvB;AACA;;AAEDL;AACA,CAnBD;;AAqBAJ,QAAQe,QAAR,GAAmB,CAACb,GAAD,EAAMC,GAAN,KAAc;AAChC;AACA;;AAEA,KAAI,CAACD,IAAIG,OAAJ,CAAYW,SAAjB,EAA4B;AAC3Bd,MAAIG,OAAJ,CAAYW,SAAZ,GAAwB,EAAxB;AACA;AACD,KAAI,CAACd,IAAIG,OAAJ,CAAYC,IAAjB,EAAuB;AACtBJ,MAAIG,OAAJ,CAAYC,IAAZ,GAAmB,EAAnB;AACA;;AAEDH,KAAIc,MAAJ,CAAW,UAAX,EAAuB;AACtBC,aAAW,cADW;AAEtBC,YAAUjB,IAAIG,OAAJ,CAAYC,IAAZ,CAAiBa,QAAjB,IAA6BjB,IAAIG,OAAJ,CAAYC,IAAZ,CAAiBa;AAFlC,EAAvB;AAIA,CAfD;;AAiBA;;;;AAIAnB,QAAQoB,SAAR,GAAoB,CAAClB,GAAD,EAAMC,GAAN,KAAc;AACjCA,KAAIc,MAAJ,CAAW,WAAX;AACA,CAFD;;AAIAjB,QAAQqB,UAAR,GAAqB,CAACnB,GAAD,EAAMC,GAAN,KAAc;AAClCA,KAAIc,MAAJ,CAAW,YAAX;AACA,CAFD;;AAIAjB,QAAQsB,UAAR,GAAqB,CAACpB,GAAD,EAAMC,GAAN,KAAc;AAClCA,KAAIc,MAAJ,CAAW,YAAX;AACA,CAFD","file":"newsController.js","sourcesContent":["require('dotenv').config({ path: './vars.env' });\n\nimport NewsApi from 'newsapi';\nconst newsapi = new NewsApi(process.env.API_KEY);\n\nexports.getNews = async (req, res, next) => {\n\t// if we have the session in the servermemory for the prototype\n\t// Skip fetching the data from the api\n\n\tif (!req.session.news) {\n\t\tconsole.debug('Making a API call');\n\t\t\n\t\treq.headline = await newsapi.v2.topHeadlines({\n\t\t\t// sources: 'bbc-news,the-verge',\n\t\t\t// q: 'iphone',\n\t\t\tcategory: 'technology',\n\t\t\tlanguage: 'en',\n\t\t\tcountry: 'us'\n\t\t});\n\t\n\t\treq.session.news = req.headline;\n\t}\n\t\n\tnext();\n}\n\nexports.homePage = (req, res) => {\n\t// If there is no selected news redirect to intro\n\t// if () {}\n\n\tif (!req.session.bookmarks) {\n\t\treq.session.bookmarks = [];\n\t}\n\tif (!req.session.news) {\n\t\treq.session.news = [];\n\t}\n\n\tres.render('homePage', {\n\t\tpageTitle: 'English news',\n\t\tarticles: req.session.news.articles && req.session.news.articles\n\t});\n}\n\n/*==========================\n=== Intro pages / onboardingish\n===========================*/\n\nexports.introPage = (req, res) => {\n\tres.render('introPage');\n}\n\nexports.introPage2 = (req, res) => {\n\tres.render('introPage2');\n}\n\nexports.introPage3 = (req, res) => {\n\tres.render('introPage3');\n}\n"]}